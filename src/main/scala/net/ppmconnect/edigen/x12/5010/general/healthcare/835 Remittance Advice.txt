package net.ppmconnect.edigen.x12
package v5010
package general
package healthcare

object RemittanceAdvice extends TransactionSetDefinition {

  object header extends HeaderDefinition {
    Segment(100,  ST, M, Once)
    Segment(200, BPR, M, Once)
    Segment(300, NTE, O, Unbounded)
    Segment(400, TRN, O, Once) // Uniquely identifies a claim payment and advice
    Segment(500, CUR, O, Once) // Does not initiate a foreign exchange transaction
    Segment(600, REF, O, Unbounded)
    Segment(700, DTM, O, Unbounded)
    Loop(Loop1000, Maximum(200))

    /**
     * Allows for name/address information for the payer and payee
     * which would be utilized to address remittance(s) for delivery
     */
    object Loop1000 extends UndelimitedLoopDefinition {
      Segment( 800,  N1, O, Once)
      Segment( 900,  N2, O, Unbounded)
      Segment(1000,  N3, O, Unbounded)
      Segment(1100,  N4, O, Once)
      Segment(1200, REF, O, Unbounded)
      Segment(1300, PER, O, Unbounded)
      Segment(1400, RDM, O, Once)
      Segment(1500, DTM, O, Once)
    }
  }

  object detail extends DetailDefinition {
    Loop(Loop2000, Unbounded)

    object Loop2000 extends UndelimitedLoopDefinition {
      Segment(30,  LX, O, Once) // Provides a looping structure and logical grouping of claim payment information
      Segment(50, TS3, O, Once)
      Segment(70, TS2, O, Once)
      Loop(Loop2100, Unbounded)

      object Loop2100 extends UndelimitedLoopDefinition {
        Segment(100, CLP, M, Once)
        Segment(200, CAS, O, Maximum(99)) // Reflects changes to amounts within the 2000 loop
        Segment(300, NM1, M, Maximum(9))
        Segment(330, MIA, O, Once)
        Segment(350, MOA, O, Once)
        Segment(400, REF, O, Maximum(99))
        Segment(500, DTM, O, Maximum(9))
        Segment(600, PER, O, Maximum(3))
        Segment(620, AMT, O, Maximum(20))
        Segment(640, QTY, O, Maximum(20))
        Loop(Loop2110, Maximum(999))

        object Loop2110 extends UndelimitedLoopDefinition {
          Segment(700, SVC, O, Once)
          /**
           * Expresses dates and date ranges specifically related to the service
           * identified in the SVC segment
           */
          Segment( 800, DTM, O, Maximum(9)) // Reflects changes to amounts within the 2000 loop
          Segment( 900, CAS, O, Maximum(99))
          Segment(1000, REF, O, Maximum(99))
          Segment(1100, AMT, O, Maximum(20))
          Segment(1200, QTY, O, Maximum(20))
          Segment(1300,  LQ, O, Maximum(99))
        }
      }
    }
  }

  object summary extends SummaryDefinition {
    Segment(100, PLB, O, Unbounded)
    Segment(200,  SE, M, Once)
  }
}
